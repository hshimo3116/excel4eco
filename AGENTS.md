# AGENTS.md

## プロジェクト概要
このプロジェクトは、.xlsm などバイナリ形式のExcelファイルのマクロを開発するものです。

## ファイル構成
- '*.xlsm'   : バイナリ形式のExcel。直接編集はGitHubやCodexからは不可能なので、マクロコードをあらかじめ抽出しておく必要がある。 
- '*.vbs'    : Windows環境下で動作可能なバイナリファイルからマクロコードを抽出するスクリプト群
- '*.bas'    : バイナリファイルから抽出したマクロコードテキスト
- '*.cls'    : バイナリファイルから抽出したマクロコードテキスト
- '*.frm'    : バイナリファイルから抽出したマクロコードテキスト
- 'Makefile' : マクロコードテキストをバイナリファイルに組み込む。結果等は各ログファイルに保存する
- 'README.md': スクリプト説明
- 'AGENTS.md': このドキュメント本体、Codexへの指示書


## ビルド・インストール方法
- 主な操作はMakefileに記述します。
- `make source`  でバイナリファイルからマクロコードを抽出します。すでにマクロコードがあった場合は、ファイルを比較して実行するかは判断します。
- `make install` でマクロコードをバイナリファイルにインストールします。すでにインストールされたコードがあった場合は、リポジトリからpullしてきたファイルを比較して実行するかは判断します。
- `make edit` で `$EDITOR`（デフォルトは emacs -nw）を使用して 各ファイルを編集可能にする。

## 開発ルール
- ソースファイルの記述はその言語規則に則る。
- 機能追加時は **README を更新**し、**バージョン定数を更新**します。
- バージョン番号はコマンドオプション、about機能等で確認ができるようにします。
- Makefile のインデントには必ずタブ文字を使用してください。

## テスト
- 設定ファイルのテストはできるのであれば提案する。

### 対象ファイル及びディレクトリ
- ファイル AGENTS.md README.md Makefile 実行ファイル
- ディレクトリ bin/ lib/
- 無視するファイル・ディレクトリ .git/ logs/

## Codexエージェントへの指示
以下の指示は、Codexへ共通する指示です。

### 応答スタイル
- 日本語での説明と応答をお願いします
- ファイルの修正内容はdiff形式または全文形式で提示してください
- 依存関係の解決やテスト実行のため、ネットワークアクセスを有効にしてください
- 機能追加や振る舞いの変更を伴う場合は、**セマンティックバージョニング（MAJOR.MINOR.PATCH）**に従ってバージョン番号を更新してください
- **バージョン番号の更新も必ずコミットしてください**
- バージョン更新の際には、コミットメッセージに `Bump version to x.y.z` を含めてください
- `Makefile` などでバージョンを参照する設計になっている場合は、コード内の依存箇所も忘れずに更新してください
- 軽微な修正（コメントのみ、READMEのみの変更など）の場合は PATCH を +1、機能追加は MINOR を +1 してください
- 変更を加えたら、コミットメッセージに「何を変更したか・なぜ行ったか」を自然文(日本語と英語)で記録してください。
- 実行したシェルコマンドやGit操作がある場合、下記の形式でログファイルとして記録してください：

### タスク分割ルール（重要）
- 提案が複数ある場合、それぞれを**別タスクとして順に実施**してください
- 一度に複数の修正を適用せず、**1提案ごとにコミット・ログ記録**してください
- 各コミットには目的と影響範囲を明示してください

### 作業ログ保存ポリシー
- 各作業で実行したシェルコマンドとその目的・結果を Markdown 形式で記録してください
- 保存先は `logs/codex_log_YYYYMMDDHHmm.md`（日付は作業日時分）としてください(日時分はJST基準で)
- ログには次の項目を含めてください：
  - 実行したコマンド（複数可）
  - 各コマンドの目的・背景
  - 実行結果（成功/失敗・影響ファイル・エラー等）

### ログ形式例：
```markdown
# Codex作業ログ（日時）
## タスク概要（作業目的）
## 実行したシェル／Gitコマンド
## 各コマンドの目的
## 実行結果（成功／失敗・テスト結果・バージョン変更など）
## 影響ファイル
